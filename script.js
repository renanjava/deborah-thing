const diseasesData = [
    {
        id: 1,
        nome: "Cancro C√≠trico",
        patogeno: "Xanthomonas citri subsp. citri",
        tipo: "bacteriana",
        severidade: "alta",
        icone: "üçã",
        classificacao: ["Plesionecr√≥tico", "Localizado"],
        descricao: "Doen√ßa bacteriana quarenten√°ria que causa les√µes caracter√≠sticas em folhas, ramos e frutos de citros, sendo de notifica√ß√£o obrigat√≥ria no Brasil.",
        sintomas: "Les√µes circulares salientes (cancros) com centro necr√≥tico e halo amarelado caracter√≠stico em folhas e frutos. As les√µes t√™m aspecto corticoso e podem causar desfolha prematura.",
        sintomas_detalhados: "Morfologia: Les√µes circulares de 2-10mm de di√¢metro, salientes, com centro necr√≥tico marrom e halo amarelo bem definido. Forma: Circular a irregular. Cor: Centro marrom-escuro com halo amarelo-claro. Padr√£o: Distribui√ß√£o aleat√≥ria na superf√≠cie foliar.",
        culturas: ["Lim√£o", "Laranja", "Tangerina", "Pomelo"],
        controle: [
            "Medidas quarenten√°rias rigorosas",
            "Elimina√ß√£o de plantas infectadas",
            "Aplica√ß√£o preventiva de compostos c√∫pricos",
            "Controle do minador-dos-citros (vetor)",
            "Desinfec√ß√£o de ferramentas",
            "Quebra-vento para reduzir dissemina√ß√£o"
        ],
        impacto: "Doen√ßa de import√¢ncia quarenten√°ria que pode inviabilizar a exporta√ß√£o de citros e causar preju√≠zos econ√¥micos de milh√µes de reais ao agroneg√≥cio brasileiro."
    },
    {
        id: 2,
        nome: "Verrugose dos Citros",
        patogeno: "Elsino√´ fawcettii",
        tipo: "fungica",
        severidade: "media",
        icone: "üçä",
        classificacao: ["Hiperpl√°stico", "Localizado"],
        descricao: "Doen√ßa f√∫ngica que causa les√µes verrucosas caracter√≠sticas em frutos jovens e folhas de citros, afetando principalmente a qualidade dos frutos.",
        sintomas: "Les√µes verrucosas, salientes e irregulares em frutos jovens. Em folhas, manchas pequenas com centro claro e bordas escuras.",
        sintomas_detalhados: "Morfologia: Les√µes verrucosas, corticosas e salientes de 1-5mm. Forma: Irregular, com superf√≠cie rugosa. Cor: Marrom-clara a escura. Padr√£o: Agrupadas em frutos jovens, esparsas em folhas maduras.",
        culturas: ["Lim√£o", "Laranja doce", "Tangerina"],
        controle: [
            "Aplica√ß√£o de fungicidas c√∫pricos",
            "Fungicidas sist√™micos em per√≠odos cr√≠ticos",
            "Poda para arejamento da copa",
            "Elimina√ß√£o de frutos afetados",
            "Controle da irriga√ß√£o"
        ],
        impacto: "Reduz significativamente o valor comercial dos frutos, especialmente para mercado in natura, podendo causar perdas de at√© 30% no valor da produ√ß√£o."
    },
    {
        id: 3,
        nome: "Morte dos Ponteiros da Manga",
        patogeno: "Lasiodiplodia theobromae",
        tipo: "fungica",
        severidade: "alta",
        icone: "ü•≠",
        classificacao: ["Holonecr√≥tico", "Sist√™mico"],
        descricao: "Doen√ßa f√∫ngica devastadora que causa necrose dos ponteiros e ramos da mangueira, podendo levar √† morte da planta em casos severos.",
        sintomas: "Necrose progressiva dos ponteiros, escurecimento vascular, gomose e morte descendente dos ramos. Folhas amarelam e secam rapidamente.",
        sintomas_detalhados: "Morfologia: Necrose descendente dos ramos, escurecimento vascular interno. Forma: Linear ao longo dos ramos. Cor: Marrom-escura a preta. Padr√£o: Progress√£o descendente dos ponteiros para ramos mais grossos.",
        culturas: ["Manga", "Caj√°", "Seriguela"],
        controle: [
            "Poda sanit√°ria dos ramos afetados",
            "Aplica√ß√£o de fungicidas sist√™micos",
            "Pasta bordalesa em ferimentos",
            "Manejo nutricional adequado",
            "Controle de estresse h√≠drico",
            "Elimina√ß√£o de material vegetal infectado"
        ],
        impacto: "Pode causar morte de plantas adultas e perdas de at√© 40% na produ√ß√£o em pomares severamente afetados, representando s√©rios preju√≠zos econ√¥micos."
    },
    {
        id: 4,
        nome: "Sigatoka da Bananeira",
        patogeno: "Mycosphaerella fijiensis",
        tipo: "fungica",
        severidade: "alta",
        icone: "üçå",
        classificacao: ["Plesionecr√≥tico", "Foliar"],
        descricao: "Doen√ßa f√∫ngica mais destrutiva da bananicultura mundial, causando necrose foliar severa e redu√ß√£o dr√°stica da produtividade.",
        sintomas: "Estrias amarelas que evoluem para manchas necr√≥ticas com halo amarelo. Coalesc√™ncia das les√µes causa necrose de grandes √°reas foliares.",
        sintomas_detalhados: "Morfologia: Inicialmente estrias clor√≥ticas de 1-2mm que evoluem para manchas el√≠pticas de 10-20mm. Forma: El√≠ptica a irregular. Cor: Centro necr√≥tico marrom com halo amarelo. Padr√£o: Paralelo √†s nervuras foliares.",
        culturas: ["Banana", "Pl√°tano"],
        controle: [
            "Aplica√ß√£o sistem√°tica de fungicidas",
            "Remo√ß√£o de folhas infectadas",
            "Melhoramento do arejamento",
            "Controle da irriga√ß√£o",
            "Uso de variedades resistentes",
            "Aduba√ß√£o equilibrada"
        ],
        impacto: "Considerada a doen√ßa mais destrutiva da bananicultura, pode causar perdas de at√© 50% na produ√ß√£o e inviabilizar o cultivo em regi√µes tropicais √∫midas."
    },
    {
        id: 5,
        nome: "Fumagina dos Citros",
        patogeno: "Capnodium citri",
        tipo: "fungica",
        severidade: "media",
        icone: "üçÉ",
        classificacao: ["Hiperpl√°stico", "Superficial"],
        descricao: "Doen√ßa f√∫ngica superficial que forma uma camada escura semelhante √† fuligem sobre folhas e frutos, reduzindo a fotoss√≠ntese.",
        sintomas: "Camada superficial escura, semelhante √† fuligem, que recobre folhas, ramos e frutos. Facilmente remov√≠vel com fric√ß√£o.",
        sintomas_detalhados: "Morfologia: Crescimento micelial superficial formando camada escura. Forma: Cobertura uniforme ou em manchas. Cor: Preta a cinza-escura. Padr√£o: Sobre melada deixada por insetos sugadores.",
        culturas: ["Lim√£o", "Laranja", "Tangerina", "Grapefruit"],
        controle: [
            "Controle de insetos sugadores (cochonilhas, pulg√µes)",
            "Lavagem das plantas com √°gua",
            "Aplica√ß√£o de √≥leo mineral",
            "Melhoria da aera√ß√£o da copa",
            "Controle de formigas"
        ],
        impacto: "Reduz a capacidade fotossint√©tica das plantas e deprecia a qualidade comercial dos frutos, causando perdas econ√¥micas moderadas."
    },
    {
        id: 6,
        nome: "Mancha de Alga do Abacate",
        patogeno: "Cephaleuros virescens",
        tipo: "algal",
        severidade: "media",
        icone: "ü•ë",
        classificacao: ["Plesionecr√≥tico", "Foliar"],
        descricao: "Doen√ßa causada por alga parasita que forma manchas caracter√≠sticas verde-alaranjadas em folhas de abacate, especialmente em regi√µes √∫midas.",
        sintomas: "Manchas circulares verde-alaranjadas com bordas bem definidas. Em casos severos, pode causar desfolha e redu√ß√£o do vigor da planta.",
        sintomas_detalhados: "Morfologia: Manchas circulares de 2-15mm de di√¢metro. Forma: Circular a oval. Cor: Verde-alaranjada a ferrug√≠nea. Padr√£o: Distribui√ß√£o aleat√≥ria na superf√≠cie foliar, mais comum na face superior.",
        culturas: ["Abacate", "Manga", "Citros"],
        controle: [
            "Aplica√ß√£o de fungicidas c√∫pricos",
            "Melhoria da aera√ß√£o da copa",
            "Controle da umidade",
            "Poda de limpeza",
            "Aduba√ß√£o equilibrada"
        ],
        impacto: "Causa desfolha prematura e redu√ß√£o do vigor das plantas, afetando a produtividade em 15-25% em condi√ß√µes favor√°veis ao pat√≥geno."
    },
    {
        id: 7,
        nome: "Podrid√£o Vermelha da Cana",
        patogeno: "Colletotrichum falcatum",
        tipo: "fungica",
        severidade: "alta",
        icone: "üéã",
        classificacao: ["Holonecr√≥tico", "Vascular"],
        descricao: "Doen√ßa f√∫ngica devastadora que causa podrid√£o interna dos colmos da cana-de-a√ß√∫car, caracterizada por colora√ß√£o avermelhada t√≠pica.",
        sintomas: "Podrid√£o interna do colmo com colora√ß√£o avermelhada caracter√≠stica. Externamente pode apresentar manchas avermelhadas e crescimento de fungos.",
        sintomas_detalhados: "Morfologia: Podrid√£o interna do colmo com descolora√ß√£o. Forma: Linear ao longo do colmo. Cor: Vermelha intensa no interior do colmo. Padr√£o: Progress√£o ascendente ou descendente no colmo.",
        culturas: ["Cana-de-a√ß√∫car"],
        controle: [
            "Uso de variedades resistentes",
            "Tratamento t√©rmico de mudas",
            "Controle de pragas que causam ferimentos",
            "Evitar ferimentos mec√¢nicos",
            "Rota√ß√£o de culturas",
            "Elimina√ß√£o de touceiras infectadas"
        ],
        impacto: "Uma das principais doen√ßas da cana-de-a√ß√∫car, pode causar perdas de 20-30% na produ√ß√£o e significativa redu√ß√£o na qualidade do caldo."
    },
    {
        id: 8,
        nome: "Encarquilhamento da Soja",
        patogeno: "Bean pod mottle virus (BPMV)",
        tipo: "viral",
        severidade: "media",
        icone: "üåø",
        classificacao: ["Hipopl√°stico", "Sist√™mico"],
        descricao: "Doen√ßa viral transmitida por besouros que causa deforma√ß√£o e encarquilhamento das folhas de soja, afetando o desenvolvimento da planta.",
        sintomas: "Encarquilhamento e deforma√ß√£o das folhas, mosaico verde-claro e escuro, nanismo da planta e redu√ß√£o no tamanho das vagens.",
        sintomas_detalhados: "Morfologia: Deforma√ß√£o foliar com encarquilhamento das bordas. Forma: Folhas distorcidas e curvadas. Cor: Mosaico de tons verdes. Padr√£o: Sintomas sist√™micos em toda a planta.",
        culturas: ["Soja", "Feij√£o"],
        controle: [
            "Controle de besouros vetores",
            "Uso de variedades resistentes",
            "Elimina√ß√£o de plantas hospedeiras alternativas",
            "Manejo integrado de pragas",
            "Rota√ß√£o de culturas"
        ],
        impacto: "Pode causar redu√ß√£o de 10-20% na produtividade e afetar a qualidade dos gr√£os, especialmente em infec√ß√µes precoces."
    },
    {
        id: 9,
        nome: "O√≠dio do Quiabo",
        patogeno: "Erysiphe cichoracearum",
        tipo: "fungica",
        severidade: "media",
        icone: "üå∂Ô∏è",
        classificacao: ["Hiperpl√°stico", "Superficial"],
        descricao: "Doen√ßa f√∫ngica que forma uma camada pulverulenta branca sobre folhas e ramos de quiabo, especialmente em condi√ß√µes de baixa umidade.",
        sintomas: "Crescimento pulverulento branco na superf√≠cie das folhas, inicialmente em manchas circulares que se expandem e coalescem.",
        sintomas_detalhados: "Morfologia: Crescimento micelial superficial pulverulento. Forma: Manchas circulares que se expandem. Cor: Branca a cinza-clara. Padr√£o: Inicialmente na face superior das folhas, expandindo-se para ambas as faces.",
        culturas: ["Quiabo", "Berinjela", "Jil√≥"],
        controle: [
            "Aplica√ß√£o de fungicidas sist√™micos",
            "Enxofre em p√≥ ou calda sulfoc√°lcica",
            "Melhoria da aera√ß√£o",
            "Evitar aduba√ß√£o nitrogenada excessiva",
            "Controle da irriga√ß√£o"
        ],
        impacto: "Reduz a capacidade fotossint√©tica das plantas e pode causar perdas de 15-30% na produ√ß√£o de frutos comerciais."
    },
    {
        id: 10,
        nome: "Ferrugem da Pitanga",
        patogeno: "Puccinia psidii",
        tipo: "fungica",
        severidade: "m√©dia",
        icone: "üçÇ",
        classificacao: ["Foliar", "Epid√©rmica"],
        descricao: "Doen√ßa f√∫ngica que afeta diversas esp√©cies da fam√≠lia Myrtaceae, incluindo a pitangueira, provocando les√µes foliares e queda prematura das folhas.",
        sintomas: "Manchas clor√≥ticas nas folhas jovens, seguidas por p√∫stulas alaranjadas na face inferior, que liberam esporos.",
        sintomas_detalhados: "Morfologia: P√∫stulas arredondadas. Cor: Laranja vivo. Localiza√ß√£o: Predominantemente na face inferior das folhas, podendo atingir ramos e frutos.",
        culturas: ["Pitangueira", "Goiabeira", "Eucalipto", "Jambol√£o"],
        controle: [
            "Plantio de variedades resistentes",
            "Poda de ramos infectados",
            "Aplica√ß√£o de fungicidas sist√™micos e de contato",
            "Evitar excesso de umidade nas folhas",
            "Remo√ß√£o de plantas hospedeiras alternativas pr√≥ximas"
        ],
        impacto: "Compromete o desenvolvimento da planta, provoca desfolha precoce, reduz a frutifica√ß√£o e afeta o valor comercial das frutas."
    }
]

const diseasesGrid = document.getElementById('diseasesGrid');
const searchInput = document.getElementById('searchInput');
const filters = document.getElementById('filters');
const noResults = document.getElementById('noResults');
const modal = document.getElementById('diseaseModal');
const modalContent = document.getElementById('modalContent');
const modalClose = document.getElementById('modalClose');

let currentFilter = 'all';
let currentSearch = '';

function renderDiseases(diseases) {
if (diseases.length === 0) {
    diseasesGrid.style.display = 'none';
    noResults.style.display = 'block';
    return;
}

diseasesGrid.style.display = 'grid';
noResults.style.display = 'none';

diseasesGrid.innerHTML = diseases.map(disease => `
    <div class="disease-card" onclick="openModal(${disease.id})">
        <div class="disease-header">
            <div class="disease-icon">${disease.icone}</div>
            <div>
                <div class="disease-title">${disease.nome}</div>
                <div class="disease-pathogen">${disease.patogeno}</div>
            </div>
        </div>
        
        <div class="disease-description">${disease.descricao}</div>
        
        <div class="disease-symptoms">
            <div class="symptoms-title">Sintomas Principais</div>
            <div class="symptoms-list">${disease.sintomas.substring(0, 120)}...</div>
        </div>
        
        <div class="disease-crops">
            ${disease.culturas.map(cultura => `<span class="crop-tag">${cultura}</span>`).join('')}
        </div>
        
        <div class="severity-indicator severity-${disease.severidade}">
            Severidade ${disease.severidade.charAt(0).toUpperCase() + disease.severidade.slice(1)}
        </div>
    </div>
`).join('');
}

function filterDiseases() {
let filtered = diseasesData;

if (currentFilter !== 'all') {
    if (currentFilter === 'alta') {
        filtered = filtered.filter(disease => disease.severidade === 'alta');
    } else {
        filtered = filtered.filter(disease => disease.tipo === currentFilter);
    }
}

if (currentSearch) {
    const searchTerm = currentSearch.toLowerCase().trim();
    filtered = filtered.filter(disease =>
        disease.nome.toLowerCase().includes(searchTerm) ||
        disease.patogeno.toLowerCase().includes(searchTerm) ||
        disease.culturas.some(cultura => cultura.toLowerCase().includes(searchTerm)) ||
        disease.sintomas.toLowerCase().includes(searchTerm) ||
        disease.descricao.toLowerCase().includes(searchTerm)
    );
}

renderDiseases(filtered);
}

function openModal(diseaseId) {
const disease = diseasesData.find(d => d.id === diseaseId);
if (!disease) return;

modalContent.innerHTML = `
    <div class="disease-header" style="margin-bottom: 25px;">
        <div class="disease-icon" style="width: 60px; height: 60px; font-size: 2rem;">${disease.icone}</div>
        <div>
            <div class="disease-title" style="font-size: 1.5rem; margin-bottom: 5px;">${disease.nome}</div>
            <div class="disease-pathogen" style="font-size: 1rem;">${disease.patogeno}</div>
            <div style="margin-top: 10px;">
                <span class="severity-indicator severity-${disease.severidade}">
                    Severidade ${disease.severidade.charAt(0).toUpperCase() + disease.severidade.slice(1)}
                </span>
            </div>
        </div>
    </div>

    <div style="margin-bottom: 20px;">
        <h3 style="color: #2c3e50; margin-bottom: 10px;">üìã Descri√ß√£o</h3>
        <p style="line-height: 1.6; color: #555;">${disease.descricao}</p>
    </div>

    <div style="margin-bottom: 20px;">
        <h3 style="color: #e74c3c; margin-bottom: 10px;">‚ö†Ô∏è Sintomas</h3>
        <p style="line-height: 1.6; color: #555;">${disease.sintomas}</p>
    </div>

    <div style="margin-bottom: 20px;">
        <h3 style="color: #3498db; margin-bottom: 10px;">üåæ Culturas Afetadas</h3>
        <div class="disease-crops">
            ${disease.culturas.map(cultura => `<span class="crop-tag">${cultura}</span>`).join('')}
        </div>
    </div>

    <div style="margin-bottom: 20px;">
        <h3 style="color: #27ae60; margin-bottom: 10px;">üõ°Ô∏è Controle e Manejo</h3>
        <p style="line-height: 1.6; color: #555;">${disease.controle}</p>
    </div>

    <div>
        <h3 style="color: #f39c12; margin-bottom: 10px;">üìä Impacto Econ√¥mico</h3>
        <p style="line-height: 1.6; color: #555;">${disease.impacto}</p>
    </div>
`;

modal.style.display = 'block';
document.body.style.overflow = 'hidden';
}

function closeModal() {
modal.style.display = 'none';
document.body.style.overflow = 'auto';
}

searchInput.addEventListener('input', (e) => {
currentSearch = e.target.value;
filterDiseases();
});

filters.addEventListener('click', (e) => {
if (e.target.classList.contains('filter-btn')) {
    filters.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));

    e.target.classList.add('active');

    currentFilter = e.target.dataset.filter;
    filterDiseases();
}
});

modalClose.addEventListener('click', closeModal);
modal.addEventListener('click', (e) => {
if (e.target === modal) closeModal();
});

document.addEventListener('keydown', (e) => {
if (e.key === 'Escape') closeModal();
});

document.addEventListener('DOMContentLoaded', () => {
renderDiseases(diseasesData);
});

window.openModal = openModal;